import pandas as pd

print("Starting Android malware dataset cleaning...")

# read dataset
df = pd.read_csv("data/raw/Android_Malware.csv", low_memory=False)

print("Original rows, columns:", df.shape)

# keep numeric columns
numeric_columns = df.select_dtypes(include=["number"]).columns.tolist()
df_clean = df[numeric_columns]

# convert label from 'Result' column
if "Result" in df.columns:
    df_clean["Label"] = df["Result"].map({0: "BENIGN", 1: "MALWARE"})
else:
    raise ValueError("Label column 'Result' not found")

# save clean copy
df_clean.to_csv("data/processed/android_malware_clean.csv", index=False)

print("Finished. Android malware clean file created.")

